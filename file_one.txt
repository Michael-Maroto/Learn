SELECT DISTINCT A.LOCATIONID,
A.PRIAGNTID,
A.AGNTID,
A.AGTNME,
A.BRAND,
A.AGTSTS AS STATUS,
A.CUSTLSTIND AS CLI,
	C.START_DATE,
    A.ACLASS AS CLASS,
    A.CLSDES AS CLASS_DESC,
    A.TRADES,
A.AADDR1,
A.AADDR2,
A.ACITY AS CITY,
CASE WHEN CONTRY IN ('US','CA')
    THEN UPPER(STATEDES)
        ELSE UPPER(ASTPRV) 
END AS STATE_PROVINCE,
    A.MTSTATUS,
    RMO_STATUS,
    PAYMENTS_STATUS
FROM ADH.AGENT_MASTER_PII.VW_AGENT_MT A 
	LEFT JOIN 
	(SELECT B.LOCATIONID,
		MIN(B.ASTRDT) AS START_DATE 
	FROM ADH.AGENT_MASTER_PII.VW_AGENT_MT B 
	WHERE B.ASTRDT != '1000-01-01' 
	GROUP BY B.LOCATIONID) C ON C.LOCATIONID = A.LOCATIONID
WHERE A.CONTRY='CR'
    AND STATUS='A'
        AND CLI='Y'
